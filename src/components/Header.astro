---
const services = [
  { label: "Ingeniería en Informática", href: "#contabilidad" },
  { label: "Diseño Gráfico", href: "#asesoria-tributaria" },
  { label: "Ingeniería Civil Industrial", href: "#gestion-laboral" },
  { label: "Ingeniería en Alimentación", href: "#constitucion" },
  { label: "Salud Enfermería", href: "#constitucion" },
];

const aboutSubmenu = [
  { label: "Misión y Visión", href: "/nosotros#nosotros" },
  { label: "Nuestra Trayectoria", href: "/nosotros#trayectoria" },
  { label: "Valores", href: "/nosotros#valores" },
  { label: "Preguntas Frecuentes", href: "/nosotros#faqs" },
];
---

<header id="header" class="fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-blue-950 to-blue-900 shadow-lg transition-all duration-300">
  <!-- Top Bar -->
  <div id="topbar" class="bg-blue-950 text-yellow-500 py-2 px-4 transition-all duration-300">
    <div class="max-w-7xl mx-auto flex flex-wrap justify-between items-center text-sm">
      <div class="flex items-center gap-4">
        <a href="tel:+56921816517" class="flex items-center gap-1 hover:text-yellow-400 transition">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" class="inline-block" viewBox="0 0 24 24" aria-hidden="true"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.79 19.79 0 0 1 2.1 4.18 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.12.9.33 1.77.63 2.6a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.48-1.2a2 2 0 0 1 2.11-.45c.83.3 1.7.51 2.6.63A2 2 0 0 1 22 16.92z"/></svg>
          <span>+56 9 2181 6517</span>
        </a>
        <a href="mailto:contacto@serviciosmvspa.cl" class="flex items-center gap-1 hover:text-yellow-400 transition">
          <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" class="inline-block" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 4h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/><path d="m22 6-10 7L2 6"/></svg>
          <span>contacto@serviciosmvspa.cl</span>
        </a>
      </div>
      <div class="text-yellow-500">
        Lunes a Viernes: 8:00 - 20:00
      </div>
    </div>
  </div>

  <!-- Main Navigation -->
  <nav id="nav" class="max-w-7xl mx-auto px-4 py-4 transition-all duration-300">
    <div class="flex justify-between items-center">
      <!-- Logo -->
      <div class="flex items-center">
        <img
          id="logo"
          src='src/assets/logo-header.png'
          alt="Logo Empresa"
          class="h-16 w-auto object-contain transition-all duration-300"
          width="128"
          height="64"
        />
      </div>

      <!-- Desktop Menu -->
      <div class="hidden md:flex items-center space-x-1">
        <a href="/#inicio" class="text-white hover:text-yellow-400 transition font-medium px-4 py-2">
          Inicio
        </a>

        <!-- Servicios Dropdown -->
        <div class="relative group">
          <button class="text-white hover:text-yellow-400 transition font-medium px-4 py-2 flex items-center gap-1">
            Servicios
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="group-hover:rotate-180 transition-transform"><path d="m6 9 6 6 6-6"/></svg>
          </button>
          <div class="absolute top-full left-0 mt-0 w-56 bg-white rounded-b-lg shadow-xl py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 ease-in-out">
            {services.map((service) => (
              <a
                href={service.href}
                class="block px-4 py-3 text-blue-950 hover:bg-yellow-50 hover:text-yellow-600 transition"
              >
                {service.label}
              </a>
            ))}
          </div>
        </div>

        <!-- Nosotros Dropdown -->
        <div class="relative group">
          <button class="text-white hover:text-yellow-400 transition font-medium px-4 py-2 flex items-center gap-1">
            Nosotros
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true" class="group-hover:rotate-180 transition-transform"><path d="m6 9 6 6 6-6"/></svg>
          </button>
          <div class="absolute top-full left-0 mt-0 w-56 bg-white rounded-b-lg shadow-xl py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 ease-in-out">
            {aboutSubmenu.map((item) => (
              <a
                href={item.href}
                class="block px-4 py-3 text-blue-950 hover:bg-yellow-50 hover:text-yellow-600 transition"
              >
                {item.label}
              </a>
            ))}
          </div>
        </div>

        <a href="#contacto" class="text-white hover:text-yellow-400 transition font-medium px-4 py-2">
          Contacto
        </a>

        <a href="#contacto" class="bg-gradient-to-r from-yellow-400 to-yellow-500 text-blue-950 px-6 py-2 rounded-lg font-semibold hover:from-yellow-500 hover:to-yellow-600 transition shadow-lg ml-4">
          Solicitar Consulta
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        class="md:hidden text-white p-2"
        aria-label="Abrir menú"
        onclick="document.getElementById('mobile-menu').classList.toggle('hidden')"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden bg-blue-900/95 border-t border-blue-800">
    <div class="max-w-7xl mx-auto px-4 py-4 space-y-2">
      <a href="#inicio" class="block text-white hover:text-yellow-400 py-2 px-4 hover:bg-blue-950/50 rounded transition" onclick="document.getElementById('mobile-menu').classList.add('hidden')">
        Inicio
      </a>

      <!-- Servicios mobile -->
      <details class="group">
        <summary class="cursor-pointer text-white hover:text-yellow-400 py-2 px-4 hover:bg-blue-950/50 rounded transition flex justify-between items-center font-medium">
          Servicios
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="group-open:rotate-180 transition-transform"><path d="m6 9 6 6 6-6"/></svg>
        </summary>
        <div class="pl-4 space-y-1">
          {services.map((service) => (
            <a
              href={service.href}
              class="block text-yellow-400 hover:text-yellow-300 py-2 px-4 hover:bg-blue-950/50 rounded transition"
              onclick="document.getElementById('mobile-menu').classList.add('hidden')"
            >
              {service.label}
            </a>
          ))}
        </div>
      </details>

      <!-- Nosotros mobile -->
      <details class="group">
        <summary class="cursor-pointer text-white hover:text-yellow-400 py-2 px-4 hover:bg-blue-950/50 rounded transition flex justify-between items-center font-medium">
          Nosotros
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="group-open:rotate-180 transition-transform"><path d="m6 9 6 6 6-6"/></svg>
        </summary>
        <div class="pl-4 space-y-1">
          {aboutSubmenu.map((item) => (
            <a
              href={item.href}
              class="block text-yellow-400 hover:text-yellow-300 py-2 px-4 hover:bg-blue-950/50 rounded transition"
              onclick="document.getElementById('mobile-menu').classList.add('hidden')"
            >
              {item.label}
            </a>
          ))}
        </div>
      </details>

      <a href="#contacto" class="block text-white hover:text-yellow-400 py-2 px-4 hover:bg-blue-950/50 rounded transition" onclick="document.getElementById('mobile-menu').classList.add('hidden')">
        Contacto
      </a>

      <a href="#contacto" class="block bg-gradient-to-r from-yellow-400 to-yellow-500 text-blue-950 px-6 py-3 rounded-lg font-semibold hover:from-yellow-500 hover:to-yellow-600 transition shadow-lg text-center mt-2" onclick="document.getElementById('mobile-menu').classList.add('hidden')">
        Solicitar Consulta
      </a>
    </div>
  </div>
</header>

<!-- Spacer para evitar que el contenido se solape -->
<div id="spacer" style="height: 140px; transition: height 0.3s;" class="hidden md:block"></div>

<script>
  const header = document.getElementById('header');
  const topbar = document.getElementById('topbar');
  const logo = document.getElementById('logo');
  const spacer = document.getElementById('spacer');
  let lastScroll = 0;

  if (header && topbar && logo && spacer) {
    window.addEventListener('scroll', () => {
      const currentScroll = window.scrollY;
      
      if (currentScroll > 50) {
        // Hacer el header más compacto
        header.classList.add('shadow-xl');
        topbar.classList.add('py-1');
        topbar.classList.remove('py-2');
        logo.classList.add('h-12');
        logo.classList.remove('h-16');
        spacer.style.height = '110px';
      } else {
        // Volver al tamaño normal
        header.classList.remove('shadow-xl');
        topbar.classList.remove('py-1');
        topbar.classList.add('py-2');
        logo.classList.remove('h-12');
        logo.classList.add('h-16');
        spacer.style.height = '140px';
      }
    });
  }
</script>